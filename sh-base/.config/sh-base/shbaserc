# sh-baserc{{{1
# source functions
if [ -d "$XDG_CONFIG_HOME/sh-base/functions" ]; then
	for functionFile in "$XDG_CONFIG_HOME/sh-base/functions"/*; do
		if [ -f "$functionFile" ]; then
			. "$functionFile"
		fi
	done
else
	printf "%s\n" "$XDG_CONFIG_HOME/sh-base/functions is missing!"
fi


# ENVIRONMENT VARIABLES{{{2
export VISUAL=nvim
export EDITOR="$VISUAL"
export SUDO_EDITOR="$VISUAL"
export TERMINAL=wezterm
export PAGER="less"
export LESS='-iMR -x4'
export LESSHISTFILE="$XDG_DATA_HOME"/less/lesshst
export MANPAGER='nvim +Man!'

# ALIASES{{{2
alias ":q"="exit" # always typing :q to exit shells, making it useful
alias ..="cd .."
alias .1="cd ../" # go back 1 directory levels
alias .2="cd ../../" # go back 2 directory levels
alias .3="cd ../../../" # go back 3 directory levels
alias ,disk="df -H" # shows disk space and percentage used
alias ,ip="dig +short myip.opendns.com @resolver1.opendns.com"
alias ,rsync="echo 'rsync --recursive --progress source/ destination/'"
alias ,shell="echo $0" # tells what shell is active
alias ,uninstall="bat $HOME/dotfiles/reference/uninstall-less.md"
alias ,weather='curl wttr.in/Pittsburgh?format="%l:+%C+%t+%w+%p+%u+%s\n"' # weather in Pittsburgh
alias b64="base64 -o b64 -i"
alias bac="bat --plain --paging=never --wrap=never"
alias bag="bat --style=header-filename,rule,numbers,grid,changes"
alias ban="bat --style=header-filename,rule,numbers,grid"
alias cd..="cd ../" # go back 1 directory level (for fast typers)
alias cp="cp -iv" # preferred "cp" implementation
alias cpy="clipcopy"
alias e="$EDITOR"
alias mkdir="mkdir -pv" # creates intermediate directories
alias mv="mv -iv" # preferred "mv" implementation
alias o="shopen"
alias pst="clippaste"
alias py2="python2"
alias py3="python3"
alias py="python"
alias pyserve="python3 -m http.server 8624 && echo 'web server on port 8624'"
alias rm="rm -i"
alias tmux="tmux -2" # set 256 colors by default
alias wget='wget --hsts-file="$XDG_CACHE_HOME/wget-hsts"' # clean up home folder
alias ytdl="youtube-dl"

# APPLICATION SPECIFIC ALIASES{{{2
exists eza && {
	alias eza="eza --icons=always"
}

exists lazygit && {
	alias lg="lazygit"
}

exists pacman && {
	alias pacnews="w3m https://www.archlinux.org/news/" # get arch news
	alias pacorph="paru -Qtdq | paru -Rns -"
	alias pacsyu="pacnews && doas pacman -Syu" # get arch news and syu
}

exists vifm && {
	alias vf="vifm"
}

exists yay && {
	alias yayu="yay --show --news && yay" # get arch news and syu with yay
}

# OS-SPECIFIC ALIASES AND ENV VARS{{{2
if [ "$(uname -s)" = "Darwin" ]; then
	export OPENER="open"
	export TEALDEER_CONFIG_DIR="$XDG_CONFIG_HOME/tealdeer"
	alias fman='man -k . | fzf --prompt="man > " | sed '\''s/([0-9a-zA-Z]*)//'\'' | awk "{print \$1}" | xargs -r man'
	alias la="ls -AxG"
	alias ll='ls -lAhFG'
	alias ls="ls -xG"
else
	if [ -r /etc/os-release ] && grep -q '^ID=arch$' /etc/os-release; then
		export OPENER="xdg-open"
	fi
	alias calc="qalc"
	alias fman='man -k . | fzf --prompt="man > " | awk "{print $1}" | xargs -r -I [] man "[]"'
	alias la='ls -x --almost-all --group-directories-first --color' # -x list entries by lines instead of cols
	alias ll='ls -l --classify --no-group --almost-all --human-readable --indicator-style=slash --time-style=long-iso --color'
	alias ls='ls -x --group-directories-first --color' # -x list entries by lines instead of cols
fi

# PATH{{{2
if [ -d "$HOME/.local/bin" ]; then
	PATH="$(printf '%s\n' "$HOME/.local/bin:$PATH" \
		| awk -v RS=: '
			!seen[$0]++ {
			printf "%s%s", (out?":":""), $0
			out=1
		}
	')"

	export PATH
fi

[ -d "$HOME/.local/bin/menu-scripts" ] && case ":$PATH:" in *":$HOME/.local/bin/menu-scripts:"*) ;; *) PATH="$PATH:$HOME/.local/bin/menu-scripts"; export PATH ;; esac

[ -d "$HOME/go/bin" ] && case ":$PATH:" in *":$HOME/go/bin:"*) ;; *) PATH="$PATH:$HOME/go/bin"; export PATH ;; esac

# SOURCE FZF_DEFAULTS{{{2
[ -f "$XDG_CONFIG_HOME/fzf/fzf.sh" ] && . "$XDG_CONFIG_HOME/fzf/fzf.sh"
#}}}
# vim:ft=sh:
