# SET TMUX TO 256 COLORS FOR VIM
#set -g default-terminal "tmux-256color"
#set -g terminal-overrides ",xterm-256color:Tc"
# Get italics working in tmux https://github.com/tmux/tmux/issues/1137
#set -as terminal-overrides ',*:smxx=\E[9m'
#set -as terminal-overrides ',xterm*:Tc:sitm=\E[3m'

# setting the delay between the prefix and command
unbind C-b
set -g prefix C-s
bind C-s send-prefix
set -s escape-time 1

set -g history-limit 100000

# Mouse
set -g mouse on
# disable mouse resizing
unbind-key -T root MouseDrag1Border

# Set index for windows starting at 1 instead of 0
set -g base-index 1

# Set index base for panes to 1 instead of 0
set-window-option -g pane-base-index 1

# Automatically renumber tmux windows
set -g renumber-windows on

# OSC-52 support
set -s set-clipboard on
set -g allow-passthrough

# Set prefix shortcut for reloading tmux config
bind R source-file $XDG_CONFIG_HOME/tmux/tmux.conf \; display-message "tmux.conf has been sourced."

# Splint windows horizonally with S and vertically with v
unbind % # Split vertically
unbind '"' # Split horizontally
unbind v
unbind s
bind v split-window -h
bind s split-window -v
unbind V
unbind S
bind V split-window -h -c "#{pane_current_path}"
bind S split-window -v -c "#{pane_current_path}"
unbind C
bind C new-window -c "#{pane_current_path}"

# list sessions interactively
unbind u
bind u choose-tree -sw

# unbind suspend tmux client and rebind to zoom
unbind C-z
bind C-z resize-pane -Z

# tmux-sessionizer
unbind C-f
unbind C-k
bind-key C-k run-shell "~/.local/bin/tmux-sessionizer.sh"

# Resize panes in window
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Use vim keybindings in copy mode
set-window-option -g mode-keys vi

# Copy Modes
#set -g copy-mode-position-style ""
#set -g copy-mode-selection-style ""
#set -g copy-mode-match-style style
#set -g copy-mode-mark-style style
#set -g copy-mode-current-match-style style
#set -g copy-mode-position-format format


# TODO: set up proper copy-paste in tmux
# https://robots.thoughtbot.com/tmux-copy-paste-on-os-x-a-better-future
# Sets up copy to system keyboard when xclip is installed on linux
# bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -sel clip -i'
# bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xsel --clipboard"

# Setup 'v' to begin selection as in Vim
bind -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send -X select-line

# Update default binding of `Enter` to also use copy-pipe
#unbind -t vi-copy Enter
#bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"

# Rename Terminals
set -g set-titles on
set -g set-titles-string " #(whoami)@#h"

# Pane Borders
set-window-option -g pane-border-style fg=cyan,bg=black
set-window-option -g pane-active-border-style fg=red,bg=black
set-window-option -g pane-border-status off
set-window-option -g pane-border-format "  #I-#P |  #{pane_current_path} |  #{pane_current_command} "
set-window-option -g pane-border-lines "heavy"

# Popups
set -g popup-style        "bg=black,fg=white"
set -g popup-border-style "fg=red"
set -g popup-border-lines "double"

# Clock Mode (prefix-t)
set -g clock-mode-colour "blue"
set -g clock-mode-style "12-with-seconds"

# Menu Styles
set -g menu-style "fg=white,bg=brightblack"
set -g menu-selected-style "fg=black,bold,italics,bg=yellow"
set -g mode-style "fg=yellow,bold,italics,bg=brightblack"

# Window list
#set-window-option is how you configure anything about how a window behaves or displays. set-option is for session/global stuff, set-window-option is for per-window customization.

# nerdfont icons to replace #F
set -g @flag_current ""
set -g @flag_last "󰁯"
set -g @flag_activity "󱅫"
set -g @flag_bell "󰂚"
set -g @flag_silent "󰂛"
set -g @flag_marked "󰃀"
set -g @flag_zoomed "󰁌"
set -gF @_win_flags \
"##{?window_activity_flag,󱅫 ,}##{?window_bell_flag,󰂚 ,}##{?window_silence_flag,󰂛 ,}##{?window_marked_flag,󰃀 ,}##{?window_zoomed_flag,󰁌 ,}##{?window_active, ,}##{?window_last_flag,󰁯 ,}"

set-window-option -g window-status-style "fg=color247,bg=color235"
set-window-option -g window-status-format "  #{E:@_win_flags}#I  "
set-window-option -g window-status-current-style "fg=black,bold,bg=yellow"
set-window-option -g window-status-current-format "  #{E:@_win_flags}#I  "

# Enable Activity Alerts
set-window-option -g monitor-activity on
set-window-option -g monitor-bell on
set-window-option -g window-status-activity-style "fg=black,bold,bg=green"
set-window-option -g window-status-bell-style "fg=white,bold,bg=red"

# command and message line
set -g message-style "fg=color17,bg=color235,align=centre"
set -g message-command-style "fg=green,bg=color235,align=centre"
set -g prompt-cursor-color "white"
set -g status-keys "vi"

# Status bar customization
set-option -g status-position bottom
set -g status-bg brightblack
set -g status-fg white

set -g status-justify absolute-centre
set -g status-interval 5
set -g status-left-length 127
set -g status-left " #[fg=magenta] #h #[default]| #[fg=green] #{pane_current_command} #[default]| #[fg=blue] #{pane_current_path}"

set -g status-right-length 36
set -g status-right "#[fg=yellow]󰃰 %a %d %I:%M%P#[fg=white] ║ #[fg=green]#I-#P  #S "
